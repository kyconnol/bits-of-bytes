<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,{post:{title:"NVMe - flash arrays unfettered",slug:"nvme",html:"\u003Ch1 id=\"nvme\"\u003ENVMe\u003C\u002Fh1\u003E\n\u003Ch2 id=\"flash-arrays-unfettered\"\u003EFlash arrays unfettered\u003C\u002Fh2\u003E\n\u003Ch3 id=\"virtira-tech-talk\"\u003EVirtira Tech Talk\u003C\u002Fh3\u003E\n\u003Ch3 id=\"kyle-connolly---may-19-2021\"\u003EKyle Connolly - May 19, 2021\u003C\u002Fh3\u003E\n\u003Chr\u003E\n\u003Ch2 id=\"non-volatile-memory-express\"\u003ENon-Volatile Memory express\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003ENVMe is a base specification (and industry standard) for how computers communicate with non-volatile memory.\u003Cul\u003E\n\u003Cli\u003EI.e. managing data in\u002Fout of Solid State Drives (SSDs) \u002F All-flash Arrays (AFAs)\u003C\u002Fli\u003E\n\u003Cli\u003EPCIe bus (locally attached storage)\u003C\u002Fli\u003E\n\u003Cli\u003Elinux kernel support beginning v3.3 (2011)\u003Cul\u003E\n\u003Cli\u003ENVMe-oF v5.0 (~2019)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003Esignificant improvements in every respect from its predecessors\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cul\u003E\n\u003Cli\u003EWhat about non-NVM types of storage?\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Chr\u003E\n\u003Ch2 id=\"the-quick-story-of-storage\"\u003EThe quick story of storage\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003ETape &amp; HDDs involve moving parts\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cul\u003E\n\u003Cli\u003ESCSI protocol\u003Cul\u003E\n\u003Cli\u003Ecirca 1986\u003C\u002Fli\u003E\n\u003Cli\u003E1 serial channel per SAS HBA (local)\u003C\u002Fli\u003E\n\u003Cli\u003E256 command queues\u003C\u002Fli\u003E\n\u003Cli\u003ESSDs, too\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Chr\u003E\n\u003Ch2 id=\"so-whats-the-point-of-nvme\"\u003ESo what&#39;s the point of NVMe?\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003ESCSI dumbs down SSDs, NVMe purpose-built for flash\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cul\u003E\n\u003Cli\u003ELargely eliminate channel\u002Fqueue bottleneck\u003Cul\u003E\n\u003Cli\u003E256 channels w\u002F 256 command queues (65k parallel queues, local PCIe)\u003C\u002Fli\u003E\n\u003Cli\u003E1 queue per CPU core (NVMe-oF)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cul\u003E\n\u003Cli\u003ELatency &amp; bandwidth improvements\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Chr\u003E\n\u003Ch2 id=\"nvme---nvme-of\"\u003ENVMe &lt;-&gt; NVMe-oF\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cp\u003ENVMe (local)\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003ENVMe-oF (remote, via a network &#39;fabric&#39;)\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E10us latency pentalty\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003EEnterprise storage typically attaches over a fabric\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Epooling, scale\u003C\u002Fli\u003E\n\u003Cli\u003EDAS vs. SAN\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Chr\u003E\n\u003Ch2 id=\"nvme-of-overview\"\u003ENVMe-oF overview\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cp\u003ESeveral types of &quot;fabric&quot; transports for NVMe\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ERDMA (RoCE, InfiniBand, iWARP)\u003C\u002Fli\u003E\n\u003Cli\u003EFC (conventional SAN)\u003C\u002Fli\u003E\n\u003Cli\u003ETCP\u002FIP\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003ERDMA\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003Erequires RNICs\u003C\u002Fli\u003E\n\u003Cli\u003E25\u002F50\u002F100 GbE\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cul\u003E\n\u003Cli\u003EFC\u003Cul\u003E\n\u003Cli\u003Econcurrent SCSI\u003C\u002Fli\u003E\n\u003Cli\u003E16\u002F32\u002F(soon)64 Gb\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cul\u003E\n\u003Cli\u003ETCP\u002FIP \u003Cul\u003E\n\u003Cli\u003Ew\u002Fo need of RDMA\u003C\u002Fli\u003E\n\u003Cli\u003E&quot;disaggregation&quot;\u003C\u002Fli\u003E\n\u003Cli\u003E10\u002F25\u002F50\u002F100 GbE\u003C\u002Fli\u003E\n\u003Cli\u003Eencapsulate command &amp; data\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Chr\u003E\n\u003Ch2 id=\"industry-examples\"\u003EIndustry examples\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003ECisco\u003Cul\u003E\n\u003Cli\u003ENVMe-ready since 2019\u003C\u002Fli\u003E\n\u003Cli\u003Eleadership positions (DIRL, 64Gb, analytics)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cul\u003E\n\u003Cli\u003EDell EMC\u003Cul\u003E\n\u003Cli\u003EPowerStore array\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cul\u003E\n\u003Cli\u003ELightbits Labs\u003Cul\u003E\n\u003Cli\u003ETCP\u002FIP\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Chr\u003E\n\u003Ch2 id=\"references\"\u003EReferences\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fnvmexpress.org\u002F\"\u003ENVMe.org\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fnvmexpress.org\u002Fwp-content\u002Fuploads\u002FNVMe-over-Fabrics-1.1-2019.10.22-Ratified.pdf#page=60&amp;zoom=100,93,165\"\u003ETransport definitions\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fnvmexpress.org\u002Feducation\u002Fdrivers\u002Flinux-driver-information\u002F\"\u003ELinux kernel support\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fyoutu.be\u002FHfcZwkPzj4w?t=580\"\u003ENVMe queue pairs in a fabric\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fyoutu.be\u002F3Z2HM3NjkJ8?t=245\"\u003EQueues table\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fyoutu.be\u002FQy1q4qT7b2M\"\u003ECraig Waters, vBrownBag\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Chr\u003E\n\u003Ch3 id=\"fin\"\u003Efin\u003C\u002Fh3\u003E\n\u003C!-- effect=stars --\u003E\n"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.f37f28e9.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@2.0.4.js";s.setAttribute("data-main","/client/client.f37f28e9.js")}document.head.appendChild(s)</script> <link href=client/client-1890402d.css rel=stylesheet><link href=client/[slug]-5bc8f95f.css rel=stylesheet> <title>NVMe - flash arrays unfettered</title> <link href=/client/client.f37f28e9.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/client-1890402d.css rel=preload as=style><link href=/client/[slug].828486bf.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/inject_styles.5607aec6.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/[slug]-5bc8f95f.css rel=preload as=style></head> <body> <div id=sapper> <main class=svelte-1uhnsl8> <div class="content svelte-emm3f3"><h1 id=nvme>NVMe</h1> <h2 id=flash-arrays-unfettered>Flash arrays unfettered</h2> <h3 id=virtira-tech-talk>Virtira Tech Talk</h3> <h3 id=kyle-connolly---may-19-2021>Kyle Connolly - May 19, 2021</h3> <hr> <h2 id=non-volatile-memory-express>Non-Volatile Memory express</h2> <ul> <li>NVMe is a base specification (and industry standard) for how computers communicate with non-volatile memory.<ul> <li>I.e. managing data in/out of Solid State Drives (SSDs) / All-flash Arrays (AFAs)</li> <li>PCIe bus (locally attached storage)</li> <li>linux kernel support beginning v3.3 (2011)<ul> <li>NVMe-oF v5.0 (~2019)</li> </ul> </li> <li>significant improvements in every respect from its predecessors</li> </ul> </li> </ul> <ul> <li>What about non-NVM types of storage?</li> </ul> <hr> <h2 id=the-quick-story-of-storage>The quick story of storage</h2> <ul> <li>Tape & HDDs involve moving parts</li> </ul> <ul> <li>SCSI protocol<ul> <li>circa 1986</li> <li>1 serial channel per SAS HBA (local)</li> <li>256 command queues</li> <li>SSDs, too</li> </ul> </li> </ul> <hr> <h2 id=so-whats-the-point-of-nvme>So what's the point of NVMe?</h2> <ul> <li>SCSI dumbs down SSDs, NVMe purpose-built for flash</li> </ul> <ul> <li>Largely eliminate channel/queue bottleneck<ul> <li>256 channels w/ 256 command queues (65k parallel queues, local PCIe)</li> <li>1 queue per CPU core (NVMe-oF)</li> </ul> </li> </ul> <ul> <li>Latency & bandwidth improvements</li> </ul> <hr> <h2 id=nvme---nvme-of>NVMe &lt;-> NVMe-oF</h2> <ul> <li><p>NVMe (local)</p> </li> <li><p>NVMe-oF (remote, via a network 'fabric')</p> <ul> <li>10us latency pentalty</li> </ul> </li> <li><p>Enterprise storage typically attaches over a fabric</p> <ul> <li>pooling, scale</li> <li>DAS vs. SAN</li> </ul> </li> </ul> <hr> <h2 id=nvme-of-overview>NVMe-oF overview</h2> <ul> <li><p>Several types of "fabric" transports for NVMe</p> <ul> <li>RDMA (RoCE, InfiniBand, iWARP)</li> <li>FC (conventional SAN)</li> <li>TCP/IP</li> </ul> </li> <li><p>RDMA</p> <ul> <li>requires RNICs</li> <li>25/50/100 GbE</li> </ul> </li> </ul> <ul> <li>FC<ul> <li>concurrent SCSI</li> <li>16/32/(soon)64 Gb</li> </ul> </li> </ul> <ul> <li>TCP/IP <ul> <li>w/o need of RDMA</li> <li>"disaggregation"</li> <li>10/25/50/100 GbE</li> <li>encapsulate command & data</li> </ul> </li> </ul> <hr> <h2 id=industry-examples>Industry examples</h2> <ul> <li>Cisco<ul> <li>NVMe-ready since 2019</li> <li>leadership positions (DIRL, 64Gb, analytics)</li> </ul> </li> </ul> <ul> <li>Dell EMC<ul> <li>PowerStore array</li> </ul> </li> </ul> <ul> <li>Lightbits Labs<ul> <li>TCP/IP</li> </ul> </li> </ul> <hr> <h2 id=references>References</h2> <ul> <li><p><a href=https://nvmexpress.org/ >NVMe.org</a></p> </li> <li><p><a href="https://nvmexpress.org/wp-content/uploads/NVMe-over-Fabrics-1.1-2019.10.22-Ratified.pdf#page=60&zoom=100,93,165">Transport definitions</a></p> </li> <li><p><a href=https://nvmexpress.org/education/drivers/linux-driver-information/ >Linux kernel support</a></p> </li> <li><p><a href="https://youtu.be/HfcZwkPzj4w?t=580">NVMe queue pairs in a fabric</a></p> </li> <li><p><a href="https://youtu.be/3Z2HM3NjkJ8?t=245">Queues table</a></p> </li> <li><p><a href=https://youtu.be/Qy1q4qT7b2M>Craig Waters, vBrownBag</a></p> </li> </ul> <hr> <h3 id=fin>fin</h3> </div></main></div> 