{"title":"NVMe - flash arrays unfettered","slug":"nvme","html":"<h1 id=\"nvme\">NVMe</h1>\n<h2 id=\"flash-arrays-unfettered\">Flash arrays unfettered</h2>\n<h3 id=\"virtira-tech-talk\">Virtira Tech Talk</h3>\n<h3 id=\"kyle-connolly---may-19-2021\">Kyle Connolly - May 19, 2021</h3>\n<hr>\n<h2 id=\"non-volatile-memory-express\">Non-Volatile Memory express</h2>\n<ul>\n<li>NVMe is a base specification (and industry standard) for how computers communicate with non-volatile memory.<ul>\n<li>I.e. managing data in/out of Solid State Drives (SSDs) / All-flash Arrays (AFAs)</li>\n<li>PCIe bus (locally attached storage)</li>\n<li>linux kernel support beginning v3.3 (2011)<ul>\n<li>NVMe-oF v5.0 (~2019)</li>\n</ul>\n</li>\n<li>significant improvements in every respect from its predecessors</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>What about non-NVM types of storage?</li>\n</ul>\n<hr>\n<h2 id=\"the-quick-story-of-storage\">The quick story of storage</h2>\n<ul>\n<li>Tape &amp; HDDs involve moving parts</li>\n</ul>\n<ul>\n<li>SCSI protocol<ul>\n<li>circa 1986</li>\n<li>1 serial channel per SAS HBA (local)</li>\n<li>256 command queues</li>\n<li>SSDs, too</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2 id=\"so-whats-the-point-of-nvme\">So what&#39;s the point of NVMe?</h2>\n<ul>\n<li>SCSI dumbs down SSDs, NVMe purpose-built for flash</li>\n</ul>\n<ul>\n<li>Largely eliminate channel/queue bottleneck<ul>\n<li>256 channels w/ 256 command queues (65k parallel queues, local PCIe)</li>\n<li>1 queue per CPU core (NVMe-oF)</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>Latency &amp; bandwidth improvements</li>\n</ul>\n<hr>\n<h2 id=\"nvme---nvme-of\">NVMe &lt;-&gt; NVMe-oF</h2>\n<ul>\n<li><p>NVMe (local)</p>\n</li>\n<li><p>NVMe-oF (remote, via a network &#39;fabric&#39;)</p>\n<ul>\n<li>10us latency pentalty</li>\n</ul>\n</li>\n<li><p>Enterprise storage typically attaches over a fabric</p>\n<ul>\n<li>pooling, scale</li>\n<li>DAS vs. SAN</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2 id=\"nvme-of-overview\">NVMe-oF overview</h2>\n<ul>\n<li><p>Several types of &quot;fabric&quot; transports for NVMe</p>\n<ul>\n<li>RDMA (RoCE, InfiniBand, iWARP)</li>\n<li>FC (conventional SAN)</li>\n<li>TCP/IP</li>\n</ul>\n</li>\n<li><p>RDMA</p>\n<ul>\n<li>requires RNICs</li>\n<li>25/50/100 GbE</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>FC<ul>\n<li>concurrent SCSI</li>\n<li>16/32/(soon)64 Gb</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>TCP/IP <ul>\n<li>w/o need of RDMA</li>\n<li>&quot;disaggregation&quot;</li>\n<li>10/25/50/100 GbE</li>\n<li>encapsulate command &amp; data</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2 id=\"industry-examples\">Industry examples</h2>\n<ul>\n<li>Cisco<ul>\n<li>NVMe-ready since 2019</li>\n<li>leadership positions (DIRL, 64Gb, analytics)</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>Dell EMC<ul>\n<li>PowerStore array</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li>Lightbits Labs<ul>\n<li>TCP/IP</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h2 id=\"references\">References</h2>\n<ul>\n<li><p><a href=\"https://nvmexpress.org/\">NVMe.org</a></p>\n</li>\n<li><p><a href=\"https://nvmexpress.org/wp-content/uploads/NVMe-over-Fabrics-1.1-2019.10.22-Ratified.pdf#page=60&amp;zoom=100,93,165\">Transport definitions</a></p>\n</li>\n<li><p><a href=\"https://nvmexpress.org/education/drivers/linux-driver-information/\">Linux kernel support</a></p>\n</li>\n<li><p><a href=\"https://youtu.be/HfcZwkPzj4w?t=580\">NVMe queue pairs in a fabric</a></p>\n</li>\n<li><p><a href=\"https://youtu.be/3Z2HM3NjkJ8?t=245\">Queues table</a></p>\n</li>\n<li><p><a href=\"https://youtu.be/Qy1q4qT7b2M\">Craig Waters, vBrownBag</a></p>\n</li>\n</ul>\n<hr>\n<h3 id=\"fin\">fin</h3>\n<!-- effect=stars -->\n"}